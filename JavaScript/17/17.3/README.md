Вместо кучи циклов теперь рекурсивная функция, которая последовательно собирает выражение. Поскольку я остаил 4 операции, то время тут 4^n, поэтому при больших n может работать слишком долго.


Также я решил тут использовать [MathJax](https://www.mathjax.org/#gettingstarted) для вывода на эран матеатических формул.